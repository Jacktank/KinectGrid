(function(a){var m={},h={},d=a.each,b=a.isArray,f=function(c,e,g){if(typeof e==="string"){b(c[e])||(c[e]=[]);c[e].push(g)}else d(e,function(n,l){f(c,n,l)})},i=function(c){return a.map(c,function(e,g){return g})},j=function(c,e,g){a.dform.hasSubscription(c)&&this.each(function(){var n=a(this);d(m[c],function(l,o){o.call(n,e,g)})});return this},k=function(c){var e=c.type,g=this;this.dform("run","[pre]",c,e);d(c,function(n,l){g.dform("run",n,l,e)});this.dform("run","[post]",c,e);return this};a.extend(a,
{keyset:i,withKeys:function(c,e){var g={};d(e,function(n,l){if(c[l])g[l]=c[l]});return g},withoutKeys:function(c,e){var g={};d(c,function(n,l){~a.inArray(n,e)||(g[n]=l)});return g},dform:{options:{prefix:"ui-dform-"},defaultType:function(c){return a("<"+c.type+">").dform("attr",c)},removeType:function(c){delete h[c]},typeNames:function(){return i(h)},addType:function(c,e){f(h,c,e)},addTypeIf:function(c,e,g){c&&a.dform.addType(e,g)},subscriberNames:function(){return a.keyset(m)},subscribe:function(c,
e){f(m,c,e)},subscribeIf:function(c,e,g){c&&a.dform.subscribe(e,g)},removeSubscription:function(c){delete m[c]},hasSubscription:function(c){return m[c]?true:false},createElement:function(c){if(!c.type)throw"No element type given! Must always exist.";var e=c.type,g=null,n=a.withoutKeys(c,["type"]);if(h[e])d(h[e],function(l,o){g=o.call(g,n)});else g=a.dform.defaultType(c);return a(g)},methods:{run:function(c,e,g){if(typeof c!=="string")return k.call(this,c);return j.call(this,c,e,g)},append:function(c,
e){if(e&&a.dform.converters&&a.isFunction(a.dform.converters[e]))c=a.dform.converters[e](c);e=a.dform.createElement(c);this.append(e);e.dform("run",c)},attr:function(c,e){var g=a.keyset(m);b(e)&&a.merge(g,e);this.attr(a.withoutKeys(c,g))},ajax:function(c,e,g){g={error:g,url:c};var n=this;typeof c!=="string"&&a.extend(g,c);g.success=function(l){n.dform(l);e(l)};a.ajax(g)},init:function(c){c=c.type?c:a.extend({type:"form"},c);if(this.is(c.type)){this.dform("attr",c);this.dform("run",c)}else this.dform("append",
c)}}}});a.fn.extend({dform:function(c){var e=a(this);a.dform.methods[c]?a.dform.methods[c].apply(e,Array.prototype.slice.call(arguments,1)):a.dform.methods.init.apply(e,arguments);return this}})})(jQuery);
(function(a){var m=a.each,h=function(b,f){return function(i){return a(b).dform("attr",i,f)}},d=function(b){var f=this;if(a.isPlainObject(b))f.dform("append",b);else a.isArray(b)?m(b,function(i,j){f.dform("append",j)}):f.html(b)};a.dform.addType({container:h("<div>"),text:h('<input type="text" />'),password:h('<input type="password" />'),submit:h('<input type="submit" />'),reset:h('<input type="reset" />'),hidden:h('<input type="hidden" />'),radio:h('<input type="radio" />'),checkbox:h('<input type="checkbox" />'),
file:h('<input type="file" />'),number:h('<input type="number" />'),url:h('<input type="url" />'),tel:h('<input type="tel" />'),email:h('<input type="email" />'),checkboxes:h("<div>",["name"]),radiobuttons:h("<div>",["name"])});a.dform.subscribe({"class":function(b){this.addClass(b)},html:d,elements:d,value:function(b){this.val(b)},css:function(b){this.css(b)},options:function(b,f){var i=this;if(f==="select"||f==="optgroup")m(b,function(j,k){j={type:"option",value:j};if(typeof k==="string")j.html=
k;if(typeof k==="object")j=a.extend(j,k);i.dform("append",j)});else if(f==="checkboxes"||f==="radiobuttons")m(b,function(j,k){var c=f==="radiobuttons"?{type:"radio"}:{type:"checkbox"};if(typeof k==="string")c.caption=k;else a.extend(c,k);c.value=j;i.dform("append",c)})},caption:function(b,f){var i={};if(typeof b==="string")i.html=b;else a.extend(i,b);if(f=="fieldset"){i.type="legend";this.dform("append",i)}else{i.type="label";if(this.attr("id"))i["for"]=this.attr("id");b=a(a.dform.createElement(i));
f==="checkbox"||f==="radio"?this.parent().append(a(b)):b.insertBefore(this);b.dform("run",i)}},type:function(b,f){a.dform.options.prefix&&this.addClass(a.dform.options.prefix+f)},url:function(){},"[post]":function(b,f){if(f==="checkboxes"||f==="radiobuttons")this.children("[type="+(f==="checkboxes"?"checkbox":"radio")+"]").each(function(){a(this).attr("name",b.name)})}})})(jQuery);
(function(a){function m(d){if(a.isFunction(d.split)){d=d.split(".");if(d.length>1){var b=d.shift();if(b=jQuery.global.localize(b))return a.getValueAt(b,d)}}return false}var h=function(d,b){return a.withKeys(b,a.keyset(a.ui[d].prototype.options))};a.dform.addTypeIf(a.isFunction(a.fn.progressbar),"progressbar",function(d){return a("<div>").dform("attr",d).progressbar(h("progressbar",d))});a.dform.addTypeIf(a.isFunction(a.fn.slider),"slider",function(d){return a("<div>").dform("attr",d).slider(h("slider",
d))});a.dform.addTypeIf(a.isFunction(a.fn.accordion),"accordion",function(d){return a("<div>").dform("attr",d)});a.dform.addTypeIf(a.isFunction(a.fn.tabs),"tabs",function(d){return a("<div>").dform("attr",d)});a.dform.subscribeIf(a.isFunction(a.fn.accordion),"entries",function(d,b){if(b=="accordion"){var f=this;a.each(d,function(i,j){i=a.extend({type:"div"},j);a(f).formElement(i);if(j.caption){j=a(f).children("div:last").prev();j.replaceWith('<h3><a href="#">'+j.html()+"</a></h3>")}})}});a.dform.subscribeIf(a.isFunction(a.fn.tabs),
"entries",function(d,b){if(b=="tabs"){var f=this;this.append("<ul>");var i=a(f).children("ul:first");a.each(d,function(j,k){j=k.id?k.id:j;a.extend(k,{type:"container",id:j});a(f).dform("append",k);k=a(f).children("div:last").prev();a(k).wrapInner(a("<a>").attr("href","#"+j));a(i).append(a("<li>").wrapInner(k))})}});a.dform.subscribeIf(a.isFunction(a.fn.dialog),"dialog",function(d,b){if(b=="form"||b=="fieldset")this.dialog(d)});a.dform.subscribeIf(a.isFunction(a.fn.resizable),"resizable",function(d){this.resizable(d)});
a.dform.subscribeIf(a.isFunction(a.fn.datepicker),"datepicker",function(d,b){b=="text"&&this.datepicker(d)});a.dform.subscribeIf(a.isFunction(a.fn.autocomplete),"autocomplete",function(d,b){b=="text"&&this.autocomplete(d)});a.dform.subscribe("[post]",function(d,b){if(this.parents("form").hasClass("ui-widget")){if((b=="button"||b=="submit")&&a.isFunction(a.fn.button))this.button();a.inArray(b,["text","textarea","password","fieldset"])!=-1&&this.addClass("ui-widget-content ui-corner-all")}if(b=="accordion"||
b=="tabs")this[b](h(b,d))});a.dform.subscribeIf(a.isFunction(a.fn.validate),{"[pre]":function(d,b){if(b=="form"){b={};if(this.hasClass("ui-widget"))b={highlight:function(f){a(f).addClass("ui-state-highlight")},unhighlight:function(f){a(f).removeClass("ui-state-highlight")}};typeof d.validate=="object"&&a.extend(b,d.validate);this.validate(b)}},validate:function(d,b){b!="form"&&this.rules("add",d)}});a.dform.subscribeIf(a.isFunction(a.fn.ajaxForm),"ajax",function(d,b){b==="form"&&this.ajaxForm(d)});
a.dform.subscribeIf(a.global&&a.isFunction(a.global.localize),"html",function(d){(d=m(d))&&a(this).html(d)});if(a.global)a.getValueAt=function(d,b){b=isArray(b)?b:b.split(".");d=d;for(var f=0;f<b.length;f++){var i=b[f];if(!d[i])return false;d=d[i]}return d};a.dform.subscribeIf(a.global,"options",function(d,b){if(b=="select"&&typeof d=="string"){a(this).html("");(d=m(d))&&a(this).dform("run","options",d,b)}})})(jQuery);
