<html>
<head>
<title>KinectGrid Settings</title>
<style>
	#settingKinectForm { }
	#settingKinectForm * span.propName { margin-right:1em; width:200px; text-align:right;color:blue;display:inline-block;}
	#settingKinectForm input { text-align:center;}
	#settingKinectForm input[type="button"] { width:3em; }

	.containerL {float:left; max-width:44em; }
</style>
<!--<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>-->
<script type="text/javascript" src="jquery_1.7.1_jquery.min.js"></script>
<script type="text/javascript" src="jquery.dform-0.2.0.min.js"></script>
<script type="text/javascript" src="json2.min.js"></script>
<script type="text/javascript" src="kinectgrid_settings.js"></script>
<script type="text/javascript" src="kinectgrid_script.js"></script>
</head>
<body>
	<div class="containerL">
		<h1>Configs</h1>
		<div id="configs">
			<input type="button" value="Load Config" onclick="loadConfig()"/>
			<input id="configFilename" type="text" size="10" value="{{LAST_SETTING_FILENAME}}" />
			<input type="button" value="Save Config" onclick="saveConfig()"/>
		</div>	
		<div>
			<p>
			<input type="button" value="Start Area Detection" onclick="areaDetection(1)"/>
			<input type="button" value="Stop Area Detection" onclick="areaDetection(0)"/>
			</p>
			<p>
			<input type="button" value="Repoke" onclick="repoke()"/>
			</p>
		</div>
		<h1>View</h1>
		<input type="button" onclick="setView(1)" value="Raw depth image" />
		<input type="button" onclick="setView(2)" value="Depth mask" />
		<input type="button" onclick="setView(3)" value="Hand,Blob view" />
		<input type="button" onclick="setView(4)" value="Areas" />
		<input type="button" onclick="setView(5)" value="Frame" />
		<input type="button" onclick="setView(6)" value="No image refresh (saves cpu time)" />
	</div>
	<div class="containerL">
		<h1>Variables</h1>
		<div id="settingKinectForm"> </div>
	</div>
	<div class="containerL">
		<h1>Calibration</h1>
		Attention: The depth values are inverted: 255=close points, 0=distant points.
		<ul>
			<li>Set Depth Range
			<ol>
				<li>Select raw depth view (press '1')</li>
				<li>Lower <i>maxDepth</i> till first obstacles are light grey.</li>
				<li>Raise <i>minDepth</i> till background is nearly black.</li>
			</ol>
			</li>
			<li>Use <i>margin[Left|Top|Right|Bottom]</i> to crop image.
			</li>
			<li>Select front mask image
			<ol>
				<li>Select front mask view (press '5')</li>
				<li>Raise <i>marginFront</i> till the frame is white and all other parts still black.</li>
			</ol>
			This black/white-image will used to find the 'holes' of your frame. Ensure that the areas are full enclosed.
			</li>
			<li>Use <i>marginBack</i> to set the minimal background threshold (depth mask) for blob detection.<br> Press '2' to show the depth mask. This global threshold will increased in two cases:
			<ol>
				<li>The depth mask will created on startup and after configuration changes. (Nearly <i>depthMask = max(sensordata, 255-marginBack)</i>). Do not block the camera during initialisation. 				
				</li>
				<li>If <i>areaThresh=1</i>, depth mask is set to frame depth inside of areas.</li>
			</ol>
			</li>
			<li>Save Configuration :-)</li>
		</ul>
	</div>
	<div class="containerL">
		<h1>Area Detection</h1>
		If calibration is finished (check front mask!) you can start the area detection. Push Hand in first area and check the output. Select more areas and finish area detection with an other push in area 1.
		<h1>Repoke</h1>
		Use this option to repeat the area detection.
	</div>
	<div class="containerL">
		<h1>Variables Description</h1>
		minBlobArea, maxBlobArea: Filter small and tall blobs out.<br>
		TUIO_2Dcur : Send tuio messages in 2Dcur format<br>
		TUIO_25Dblb : Send tuio messages in 25Dblb format (like Space Palette).<br>
		areaThresh : Use depth of the frame to filter hand movement behind the frame.<br>
		directFiltering: Skip depthFrame evaluation to avoid some memcpy. (For ARM, Slower on x86.)<br>
	</div>
</body>
